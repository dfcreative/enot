'use strict';var f=module.exports={},h=require("matches-selector"),k=require("each-csv"),l=require("mutypes"),m=l.isString,n=l.isElement,p=l.isPlain,q=(0,eval)("this"),r=q.document,s={ENTER:13,ESCAPE:27,TAB:9,ALT:18,CTRL:17,SHIFT:16,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,LEFT_MOUSE:1,RIGHT_MOUSE:3,MIDDLE_MOUSE:2},$=q.jQuery,t=/\s*,\s*/;
function u(a,b,c){var d={},e=b.match(/\w+(?:\:\w+(?:\(.+\))?)*$/)[0];a=(b=b.slice(0,-e.length).trim())?/^[.#[]/.test(b)&&r?r.querySelectorAll(b):/^this\./.test(b)?v(a,b.slice(5)):b[0]===w?v(a,b.slice(1)):"this"===b?a:b===w?a:"body"===b?document.body:"root"===b?document.documentElement:v(q,b):a;d.c=a;e=("on"===e.slice(0,2)?e.slice(2):e).split(":");d.a=e.shift();d.b=e;c&&(d.d=x(c,d));return d}var w="@";function v(a,b){for(var c=b.split("."),d=a,e;void 0!==(e=c.shift());)d=d[e];return d}
function x(a,b){var c=a;b.b.sort(function(d){return/^one/.test(d)?1:-1}).forEach(function(d){var a=d.split("(")[0];d=d.slice(a.length+1,-1);f.b[a]&&(c=f.b[a](b.a,c,d))});return c}var y=new WeakMap,z=new WeakMap;f.on=function(a,b,c){m(a)&&(c=b,b=a,a=null);if(!b)return!1;k(b,function(d){A(a,d,c)})};var B={};
function A(a,b,c){var d=u(a,b,c);a=d.c;var e=d.d;if(a)if(a.length&&!n(a))for(b=a.length;b--;)A(a[b],d.a,e);else{void 0===c&&(e=c=a[d.a]);if(p(c))c+="",e=f.b.fire(b,null,c),(B[c]=B[c]||{})[d.a]=e;else if(e!==c){y.has(c)||y.set(c,{});b=y.get(c);if(b[d.a])return;b[d.a]=e}d=d.a;if(a&&a.addEventListener)if($)$(a).on(d,e);else a.addEventListener(d,e);else z.has(a)||z.set(a,{}),a=z.get(a),(a[d]=a[d]||[]).push(e)}}f.off=function(a,b,c){m(a)&&(c=b,b=a,a=null);b&&k(b,function(d){C(a,d,c)})};
function C(a,b,c){var d=u(a,b);a=d.c;b=c;if(a)if(a.length&&!n(a))for(c=a.length;c--;)C(a[c],d.a,b);else if(void 0===c&&(b=c=a[d.a]),p(c)?(c+="",B[c]&&(b=B[c][d.a],B[c][d.a]=null)):y.has(c)&&(c=y.get(c),c[d.a]&&(b=c[d.a],c[d.a]=null)),d=d.a,a&&a.addEventListener)$?$(a).off(d,b):a.removeEventListener(d,b);else if(z.has(a)&&(a=z.get(a)[d]))for(d=0;d<a.length;d++)if(a[d]===b){a.splice(d,1);break}}
f.fire=function(a,b,c,d){m(a)&&(d=c,c=b,b=a,a=null);if(b instanceof Event)return D(a,b);if(!b)return!1;k(b,function(b){var g=u(a,b);return g.a?x(function(){var a=g.c;if(!a)return a;if(a.length&&!n(a))for(var b=a.length;b--;)D(a[b],g.a,c,d);else D(a,g.a,c,d)},g)():!1})};
function D(a,b,c,d){if(a&&a.addEventListener)if($){var e=$.Event(b,c);e.detail=c;d?$(a).trigger(e):$(a).triggerHandler(e)}else b instanceof Event?e=b:(e=r.createEvent("CustomEvent"),e.initCustomEvent(b,d,null,c)),a.dispatchEvent(e);else if(z.has(a)&&(d=z.get(a)[b]))for(var e=0,g=d.length;e<g;e++)d[e]&&d[e].call(a,{detail:c,type:b})}f.b={};f.b.one=function(a,b){function c(d){d=b&&b.call(this,d);1!==d&&f.off(this,a,c);return d}return c};
f.b.pass=function(a,b,c){c=c.split(t).map(F);return function(a){for(var e,g=c.length;g--;){e=c[g];var E="originalEvent"in a?a.originalEvent.which:a.which;if(e in s&&s[e]==E||E==e)return b.call(this,a)}return 1}};f.b.delegate=function(a,b,c){return function(a){var e=a.target;if(!n(e))return 1;for(;e&&e!==this;){if(h(e,c))return a.delegateTarget=e,Object.defineProperty(a,"currentTarget",{get:function(){return e}}),b.call(this,a);e=e.parentNode}return 1}};
f.b.not=function(a,b,c){return function(a){for(var e=a.target;e&&e!==this;){if(h(e,c))return 1;e=e.parentNode}return b.call(this,a)}};var G=new WeakMap;f.b.throttle=function(a,b,c){c=parseFloat(c);return function(a){var e=this;if(G.get(e))return 1;a=b.call(e,a);if(1===a)return a;G.set(e,setTimeout(function(){clearInterval(G.e);G.delete(e)},c))}};f.b.defer=function(a,b,c){c=parseFloat(c);return function(a){var e=this;setTimeout(function(){return b.call(e,a)},c)}};
f.b.fire=function(a,b,c){var d=c+"";return function(a){var b=this;k(d,function(c){D(b,c,a.detail)})}};function F(a){return a.toUpperCase()};
