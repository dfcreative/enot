var f=module.exports={},k=require("object-id"),m=require("matches-selector"),n=require("each-csv"),p=(0,eval)("this"),q=p.document,r={ENTER:13,ESCAPE:27,TAB:9,ALT:18,CTRL:17,SHIFT:16,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,LEFT_MOUSE:1,RIGHT_MOUSE:3,MIDDLE_MOUSE:2},$=p.jQuery,s=/\s*,\s*/,t={};
function u(e,a,d){var c={},b=a.match(/\w+(?:\:\w+(?:\(.+\))?)*$/)[0];e=(a=a.slice(0,-b.length).trim())?/^[.#[]/.test(a)&&q?q.querySelector(a):/^this\./.test(a)?e[a.slice(5)]:"@"===a[0]?e[a.slice(1)]:"this"===a?e:"@"===a?e:"body"===a?document.body:"root"===a?document.documentElement:p[a]:e;c.c=e;b=("on"===b.slice(0,2)?b.slice(2):b).split(":");c.a=b.shift();c.b=b;d&&(c.e=v(d,c));return c}
function v(e,a){var d=e;a.b.sort(function(c){return/^one/.test(c)?1:-1}).forEach(function(c){var b=c.split("(")[0];c=c.slice(b.length+1,-1);f.b[b]&&(d=f.b[b](a.a,d,c))});return d}f.on=function(e,a,d){if(!a)return!1;n(a,function(c){var b=e,a=u(b,c,d),b=a.c,g=a.e;if(b){var l=k(b);c="_on"+l+c;if(!d[c])if(d[c]=g,f.d(b))if($)$(b).on(a.a,g);else b.addEventListener(a.a,g);else b=t[l]=t[l]||{},(b[a.a]=b[a.a]||[]).push(g)}})};
f.off=function(e,a,d){if(!a)return!1;n(a,function(a){var b=e;if(d){var h=u(b,a);if(b=h.c){var g=k(b);a="_on"+g+a;var l=d[a]||d;d[a]=null;if(f.d(b))$?$(b).off(h.a,l):b.removeEventListener(h.a,l);else if(b=(t[g]=t[g]||{})[h.a])for(g=0;g<b.length;g++)if(h=b[g],h===d||h.fn===d){b.splice(g,1);break}}}})};f.fire=function(e,a,d,c){if(a instanceof Event)return w(e,a);if(!a)return!1;n(a,function(b){var a=u(e,b);return a.a?v(function(){w(a.c,a.a,d,c)},a)():!1})};
function w(e,a,d,c){if(!e)return e;var b=k(e);if(f.d(e))$?(b=$.Event(a,d),b.detail=d,c?$(e).trigger(b):$(e).triggerHandler(b)):(a instanceof Event?b=a:(b=q.createEvent("CustomEvent"),b.initCustomEvent(a,c,null,d)),e.dispatchEvent(b));else if(a=(t[b]=t[b]||{})[a])for(a=a.slice(0),c=0,b=a.length;c<b;++c)a[c].call(e,d)}f.b={};f.b.one=function(e,a){function d(c){c=a&&a.call(this,c);1!==c&&f.off(this,e,d);return c}return d};
f.b.pass=function(e,a,d){d=d.split(s).map(x);return function(c){for(var b,e=d.length;e--;){b=d[e];var g="originalEvent"in c?c.originalEvent.which:c.which;if(b in r&&r[b]==g||g==b)return a.call(this,c)}return 1}};f.b.delegate=function(e,a,d){return function(c){if(!(c.target instanceof HTMLElement))return 1;for(var b=c.target;b&&b!==this;){if(m(b,d))return a.call(this,c);b=b.parentNode}return 1}};var y={};
f.b.throttle=function(e,a,d){d=parseFloat(d);return function(c){var b="_throttle"+k(this)+e;if(y[b])return 1;c=a.call(this,c);if(1===c)return c;y[b]=setTimeout(function(){clearInterval(y[b]);y[b]=null},d)}};f.b.defer=function(e,a,d){d=parseFloat(d);return function(c){var b=this;setTimeout(function(){return a.call(b,c)},d)}};f.d=function(e){return e&&!!e.addEventListener};function x(e){return e.toUpperCase()};
